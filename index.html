<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<style>
		:root {
			--main-color: #4caf50; /* يمكنك تغيير اللون الأساسي حسب رغبتك */
			--border-radius: 8px;
		}

		/* الحاوية الأساسية لكل الأزرار */
		.toggle-wrapper {
			display: flex;
			flex-direction: row;
			border: 1px solid #ccc; /* إطار خارجي خفيف حول المجموعة */
			border-radius: var(--border-radius);
			overflow: hidden; /* لمنع أي تجاوز للأزرار */
			background-color: #fff; /* خلفية بيضاء أسفل الأزرار */
		}

		/* كل جزء (Segment) */
		.toggle-segment {
			flex: 1;
			position: relative;
		}

		/* إخفاء مربعات الاختيار */
		.toggle-segment input {
			position: absolute;
			opacity: 0;
			width: 0;
			height: 0;
		}

		/* التنسيق الافتراضي للتسمية (label) قبل الاختيار */
		.toggle-segment label {
			display: block;
			padding: 12px 16px;
			text-align: center;
			cursor: pointer;
			transition: all 0.3s ease;
			color: #666; /* لون النص الافتراضي */
			font-family: Arial, sans-serif;
			font-weight: normal; /* نص غير عريض للأزرار غير المختارة */
			background-color: #f8f8f8; /* خلفية خفيفة للأزرار غير المختارة */
			border-right: 1px solid #ccc; /* فاصل بين الأزرار */
			margin: 0; /* إزالة أي فراغات إضافية */
		}

		/* إزالة الحد الفاصل من آخر عنصر */
		.toggle-segment:last-child label {
			border-right: none;
		}

		/* عند تمرير الفأرة (Hover) */
		.toggle-segment label:hover {
			background-color: #eee; /* تفتيح إضافي للخلفية */
		}

		/* تنسيق التسمية عند اختيار الزر */
		.toggle-segment input:checked + label {
			background-color: #fff; /* خلفية بيضاء للزر المختار */
			color: #000; /* لون النص داكن */
			font-weight: bold; /* نص عريض للتبويب المختار */
			border: 1px solid var(--main-color); /* إطار بلون مميز */
			border-radius: var(--border-radius); /* نفس درجة انحناء الحواف */
			margin: -1px; /* تعويض الإطار الجديد حتى لا يكبر حجم الزر */
			z-index: 1; /* رفع التبويب المختار للأمام */
		}

		/* تنسيق خاص للشاشات الأصغر (عرض عمودي) */
		@media (max-width: 767px) {
			.toggle-wrapper {
				flex-direction: column;
			}
			.toggle-segment label {
				border-right: none;
				border-bottom: 1px solid #ccc;
			}
			.toggle-segment:last-child label {
				border-bottom: none;
			}
		}
	</style>
	<body>
		<div class="toggle-wrapper" id="buttonContainer">
			<div class="toggle-segment">
				<input
					type="radio"
					name="toggleGroup"
					id="option1"
					value="for_rent"
					checked
				/>
				<label for="option1">For rent</label>
			</div>
			<div class="toggle-segment">
				<input
					type="radio"
					name="toggleGroup"
					id="option2"
					value="for_sale"
				/>
				<label for="option2">For sale</label>
			</div>
			<div class="toggle-segment">
				<input
					type="radio"
					name="toggleGroup"
					id="option3"
					value="direct_color"
				/>
				<label for="option3">Direct color</label>
			</div>
		</div>
		<input
			type="hidden"
			id="selectedValue"
			name="selectedValue"
			value="for_rent"
		/>

		<script>
			// Default Configuration
			const defaultConfig = {
				options: ['For rent', 'For sale', 'Direct color'],
				mainColor: '#4CAF50',
			}

			// JotForm Widget Settings
			JotForm.setWidgetSettings([
				{
					type: 'text',
					name: 'options',
					label: 'Options (comma separated)',
					value: defaultConfig.options.join(', '),
				},
				{
					type: 'color',
					name: 'mainColor',
					label: 'Main Color',
					value: defaultConfig.mainColor,
				},
			])

			function updateDesign(settings) {
				const options = settings.options.split(',').map((o) => o.trim())
				const container = document.getElementById('buttonContainer')

				// Update CSS Variables
				document.documentElement.style.setProperty(
					'--main-color',
					settings.mainColor
				)

				// Generate New Segments
				container.innerHTML = options
					.map(
						(text, index) => `
     <div class="toggle-segment">
       <input type="radio" name="toggleGroup" id="option${index + 1}" 
              value="${text.toLowerCase().replace(/ /g, '_')}" ${
							index === 0 ? 'checked' : ''
						}>
       <label for="option${index + 1}">${text}</label>
     </div>
   `
					)
					.join('')

				// Update Hidden Input
				document.getElementById('selectedValue').value = options[0]
					.toLowerCase()
					.replace(/ /g, '_')
			}

			// Initialize Widget
			window.JotForm &&
				JotForm.initializeWidget({
					widgetId: 'unifiedToggleButton',
					init: function (settings) {
						const finalSettings = {
							options:
								settings?.options || defaultConfig.options.join(', '),
							mainColor: settings?.mainColor || defaultConfig.mainColor,
						}
						updateDesign(finalSettings)
					},
					bind: function () {
						const fieldId = this.getFormFieldId()
						document.getElementById('selectedValue').name = fieldId
					},
					clear: function () {
						const firstInput = document.querySelector(
							'input[type="radio"]'
						)
						if (firstInput) {
							firstInput.checked = true
							document.getElementById('selectedValue').value =
								firstInput.value
						}
					},
					settingsUpdated: function (newSettings) {
						updateDesign(newSettings)
					},
				})

			// Handle Selection Changes
			document.addEventListener('change', (e) => {
				if (e.target.name === 'toggleGroup') {
					document.getElementById('selectedValue').value = e.target.value
				}
			})
		</script>
	</body>
</html>
